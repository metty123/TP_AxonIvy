[Ivy]
[>Created: Thu Jun 26 13:49:58 ICT 2014]
13C6FDFBECF1930D 3.17 #module
>Proto >Proto Collection #zClass
Ds0 DeployProcess Big #zClass
Ds0 RD #cInfo
Ds0 #process
Ds0 @TextInP .ui2RdDataAction .ui2RdDataAction #zField
Ds0 @TextInP .rdData2UIAction .rdData2UIAction #zField
Ds0 @TextInP .resExport .resExport #zField
Ds0 @TextInP .type .type #zField
Ds0 @TextInP .processKind .processKind #zField
Ds0 @AnnotationInP-0n ai ai #zField
Ds0 @TextInP .xml .xml #zField
Ds0 @TextInP .responsibility .responsibility #zField
Ds0 @RichDialogInitStart f0 '' #zField
Ds0 @RichDialogProcessEnd f1 '' #zField
Ds0 @PushWFArc f2 '' #zField
Ds0 @RichDialogMethodStart f3 '' #zField
Ds0 @RichDialogProcessStep f4 '' #zField
Ds0 @RichDialogProcessEnd f6 '' #zField
Ds0 @RichDialogMethodStart f8 '' #zField
Ds0 @PushWFArc f9 '' #zField
Ds0 @RichDialogMethodStart f10 '' #zField
Ds0 @PushWFArc f11 '' #zField
Ds0 @RichDialogMethodStart f12 '' #zField
Ds0 @RichDialogFireEvent f13 '' #zField
Ds0 @Alternative f19 '' #zField
Ds0 @RichDialogProcessStep f21 '' #zField
Ds0 @PushWFArc f22 '' #zField
Ds0 @RichDialogProcessStep f24 '' #zField
Ds0 @PushWFArc f7 '' #zField
Ds0 @PushWFArc f16 '' #zField
Ds0 @PushWFArc f17 '' #zField
Ds0 @PushWFArc f18 '' #zField
Ds0 @RichDialogMethodStart f20 '' #zField
Ds0 @PushWFArc f23 '' #zField
Ds0 @RichDialogProcessStep f25 '' #zField
Ds0 @PushWFArc f26 '' #zField
Ds0 @PushWFArc f15 '' #zField
Ds0 @RichDialogMethodStart f27 '' #zField
Ds0 @RichDialogProcessStep f28 '' #zField
Ds0 @PushWFArc f29 '' #zField
Ds0 @Alternative f31 '' #zField
Ds0 @RichDialogProcessStep f34 '' #zField
Ds0 @PushWFArc f33 '' #zField
Ds0 @RichDialogFireEvent f36 '' #zField
Ds0 @PushWFArc f32 '' #zField
Ds0 @RichDialogFireEvent f41 '' #zField
Ds0 @PushWFArc f42 '' #zField
Ds0 @RichDialogMethodStart f38 '' #zField
Ds0 @RichDialogProcessEnd f39 '' #zField
Ds0 @PushWFArc f46 '' #zField
Ds0 @RichDialogProcessStep f14 '' #zField
Ds0 @Alternative f45 '' #zField
Ds0 @PushWFArc f47 '' #zField
Ds0 @RichDialogProcessStep f48 '' #zField
Ds0 @PushWFArc f49 '' #zField
Ds0 @RichDialogProcessEnd f50 '' #zField
Ds0 @PushWFArc f51 '' #zField
Ds0 @Alternative f57 '' #zField
Ds0 @RichDialog f59 '' #zField
Ds0 @RichDialogProcessEnd f61 '' #zField
Ds0 @PushWFArc f35 '' #zField
Ds0 @PushWFArc f40 '' #zField
Ds0 @RichDialogProcessStep f54 '' #zField
Ds0 @PushWFArc f55 '' #zField
Ds0 @PushWFArc f56 '' #zField
Ds0 @RichDialogProcessStart f63 '' #zField
Ds0 @RichDialogProcessEnd f64 '' #zField
Ds0 @PushWFArc f52 '' #zField
Ds0 @PushWFArc f58 '' #zField
Ds0 @RichDialogProcessStep f60 '' #zField
Ds0 @PushWFArc f62 '' #zField
Ds0 @PushWFArc f37 '' #zField
Ds0 @PushWFArc f43 '' #zField
Ds0 @RichDialogProcessStep f65 '' #zField
Ds0 @PushWFArc f66 '' #zField
Ds0 @PushWFArc f44 '' #zField
Ds0 @PushWFArc f72 '' #zField
Ds0 @PushWFArc f67 '' #zField
Ds0 @RichDialogMethodStart f5 '' #zField
Ds0 @PushWFArc f30 '' #zField
>Proto Ds0 Ds0 DeployProcess #zField
Ds0 f0 guid 13A2104B7E56BA9F #txt
Ds0 f0 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f0 method start() #txt
Ds0 f0 disableUIEvents true #txt
Ds0 f0 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f0 outParameterDecl '<> result;
' #txt
Ds0 f0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>start()</name>
    </language>
</elementInfo>
' #txt
Ds0 f0 86 54 20 20 13 0 #rect
Ds0 f0 @|RichDialogInitStartIcon #fIcon
Ds0 f1 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f1 86 206 20 20 13 0 #rect
Ds0 f1 @|RichDialogProcessEndIcon #fIcon
Ds0 f2 expr out #txt
Ds0 f2 96 74 96 206 #arcP
Ds0 f3 guid 13A25A9C521D2B2B #txt
Ds0 f3 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f3 method deploy() #txt
Ds0 f3 disableUIEvents false #txt
Ds0 f3 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f3 outParameterDecl '<> result;
' #txt
Ds0 f3 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>deploy()</name>
    </language>
</elementInfo>
' #txt
Ds0 f3 230 54 20 20 13 0 #rect
Ds0 f3 @|RichDialogMethodStartIcon #fIcon
Ds0 f4 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f4 actionTable 'out=in;
' #txt
Ds0 f4 actionCode 'import ch.ivyteam.ivy.admin.tool.deploymentwizardserver.common.ProgressMonitor;
import ch.ivyteam.ivy.admin.tool.deploymentwizardserver.deployment.DeploymentLogger;
import ch.ivyteam.ivy.admin.tool.deploymentwizardserver.deployment.DeploymentManager;
import org.eclipse.core.runtime.SubProgressMonitor;
import com.ulcjava.base.application.ClientContext;

// set user host and login user 
String user = ivy.session.getSessionUserName();
String host = "";

try 
{
	host = ClientContext.getHost();
	// Begin deploy
	panel.textAreaDeployLog.setText("");
	in.progressMonitor = new ProgressMonitor();
	in.progressMonitor.beginTask("", in.projectList.size() * DeploymentManager.LENGTH_PER_DEPLOY);
	SubProgressMonitor subProgressMonitor = new SubProgressMonitor(in.progressMonitor, in.progressMonitor.getTotalWork(), 4);
		
	in.log = new DeploymentLogger();
	in.indexLog = 0;
	DeploymentLogger.getDeploymentLogInfo().clear();
	in.deployer = new DeploymentManager(in.appList, in.projectList, subProgressMonitor, in.log, user, host);
  in.deployer.start();
	panel.startPollingTimer();
	in.isDeploymentFailed = false;
} 
catch (Exception ex)
{
	panel.textAreaDeployLog.appendLine(ex.getMessage());
	in.isDeploymentFailed = true;
}

' #txt
Ds0 f4 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f4 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Deploy projects</name>
        <nameStyle>15,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f4 222 196 36 24 20 -2 #rect
Ds0 f4 @|RichDialogProcessStepIcon #fIcon
Ds0 f6 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f6 230 630 20 20 13 0 #rect
Ds0 f6 @|RichDialogProcessEndIcon #fIcon
Ds0 f8 guid 13A25BF61692D5CA #txt
Ds0 f8 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f8 method setProjectList(List<ch.ivyteam.ivy.admin.tool.deploymentwizardserver.ProjectInfo>) #txt
Ds0 f8 disableUIEvents false #txt
Ds0 f8 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<List<ch.ivyteam.ivy.admin.tool.deploymentwizardserver.ProjectInfo> projectList> param = methodEvent.getInputArguments();
' #txt
Ds0 f8 inActionCode 'out.projectList.clear();
out.projectList.addAll(param.projectList);' #txt
Ds0 f8 outParameterDecl '<> result;
' #txt
Ds0 f8 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setProjectList(List&lt;ProjectInfo&gt;)</name>
        <nameStyle>33,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f8 366 54 20 20 13 0 #rect
Ds0 f8 @|RichDialogMethodStartIcon #fIcon
Ds0 f9 expr out #txt
Ds0 f9 376 74 250 640 #arcP
Ds0 f9 1 376 640 #addKink
Ds0 f9 0 0.9773405880524952 0 0 #arcLabel
Ds0 f10 guid 13A25D476AE7DA3C #txt
Ds0 f10 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f10 method setAppList(List<ch.ivyteam.ivy.application.IApplication>) #txt
Ds0 f10 disableUIEvents false #txt
Ds0 f10 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<List<ch.ivyteam.ivy.application.IApplication> appList> param = methodEvent.getInputArguments();
' #txt
Ds0 f10 inActionCode 'out.appList.clear();
out.appList.addAll(param.appList);' #txt
Ds0 f10 outParameterDecl '<> result;
' #txt
Ds0 f10 outActionCode '
' #txt
Ds0 f10 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setAppList(List&lt;IApplication&gt;)</name>
        <nameStyle>30,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f10 446 198 20 20 13 0 #rect
Ds0 f10 @|RichDialogMethodStartIcon #fIcon
Ds0 f11 expr out #txt
Ds0 f11 456 218 250 640 #arcP
Ds0 f11 1 456 640 #addKink
Ds0 f11 1 0.30434520506290896 0 0 #arcLabel
Ds0 f12 guid 13A2A2BDF982D890 #txt
Ds0 f12 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f12 method timer() #txt
Ds0 f12 disableUIEvents false #txt
Ds0 f12 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>timer()</name>
    </language>
</elementInfo>
' #txt
Ds0 f12 726 54 20 20 13 0 #rect
Ds0 f12 @|RichDialogMethodStartIcon #fIcon
Ds0 f13 actionCode panel.fireEnableFinishButton(); #txt
Ds0 f13 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f13 fireEvent enableFinishButton() #txt
Ds0 f13 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>enable Finish button</name>
        <nameStyle>20
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f13 1086 628 36 24 -37 16 #rect
Ds0 f13 @|RichDialogFireEventIcon #fIcon
Ds0 f19 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f19 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>is running?</name>
        <nameStyle>11
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f19 722 194 28 28 14 0 #rect
Ds0 f19 @|AlternativeIcon #fIcon
Ds0 f21 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f21 actionTable 'out=in;
' #txt
Ds0 f21 actionCode panel.restartPollingTimer(); #txt
Ds0 f21 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f21 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>restart timer</name>
        <nameStyle>13
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f21 718 324 36 24 -40 17 #rect
Ds0 f21 @|RichDialogProcessStepIcon #fIcon
Ds0 f22 expr in #txt
Ds0 f22 outCond in.deployer.isRunning() #txt
Ds0 f22 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
        <nameStyle>3
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f22 736 222 736 324 #arcP
Ds0 f22 0 0.4117647058823529 -15 0 #arcLabel
Ds0 f24 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f24 actionTable 'out=in;
' #txt
Ds0 f24 actionCode 'panel.stopPollingTimer();




' #txt
Ds0 f24 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f24 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>stop timer</name>
        <nameStyle>10,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f24 918 228 36 24 20 -2 #rect
Ds0 f24 @|RichDialogProcessStepIcon #fIcon
Ds0 f7 expr out #txt
Ds0 f7 240 220 240 630 #arcP
Ds0 f16 expr in #txt
Ds0 f16 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>no</name>
        <nameStyle>2
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f16 750 208 936 228 #arcP
Ds0 f16 1 936 208 #addKink
Ds0 f16 1 0.2692307692307692 11 0 #arcLabel
Ds0 f17 expr out #txt
Ds0 f17 736 348 250 640 #arcP
Ds0 f17 1 736 640 #addKink
Ds0 f17 1 0.38637993869295795 0 0 #arcLabel
Ds0 f18 expr out #txt
Ds0 f18 1086 640 250 640 #arcP
Ds0 f18 0 0.495867238738597 0 0 #arcLabel
Ds0 f20 guid 13A402A070558F29 #txt
Ds0 f20 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f20 method appendLog(String) #txt
Ds0 f20 disableUIEvents false #txt
Ds0 f20 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String log> param = methodEvent.getInputArguments();
' #txt
Ds0 f20 inActionCode 'panel.textAreaDeployLog.appendLine("\n " + param.log);' #txt
Ds0 f20 outParameterDecl '<> result;
' #txt
Ds0 f20 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>appendLog(String)</name>
        <nameStyle>17,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f20 558 254 20 20 13 0 #rect
Ds0 f20 @|RichDialogMethodStartIcon #fIcon
Ds0 f23 expr out #txt
Ds0 f23 568 274 250 640 #arcP
Ds0 f23 1 568 640 #addKink
Ds0 f23 1 0.28003220896592707 0 0 #arcLabel
Ds0 f25 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f25 actionTable 'out=in;
' #txt
Ds0 f25 actionCode 'import java.util.Iterator;
import ch.ivyteam.ivy.admin.tool.deploymentwizardserver.deployment.DeploymentLogger;

try 
{
	panel.lblDeployStatus.setText(in.progressMonitor.getCurrentTaskName());

	java.util.List<String> logList = DeploymentLogger.getDeploymentLogInfo().clone();
	
	for (int i = in.indexLog; i < logList.size(); i ++)
	{
		panel.textAreaDeployLog.appendLine(logList.get(i).toString());
	}	
	
	in.indexLog = DeploymentLogger.getDeploymentLogInfo().size();
	
	if (in.deployer.isFailActivation() || in.deployer.isFailRelease()) {
		panel.lblWarning.setText(ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/message/warningDeploymentFinishedPartially"));
	}
}
catch (Exception ex)
{
	panel.textAreaDeployLog.appendLine(ex.getMessage());
	in.isDeploymentFailed = true;
}' #txt
Ds0 f25 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f25 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>update  status</name>
        <nameStyle>14,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f25 718 124 36 24 20 -2 #rect
Ds0 f25 @|RichDialogProcessStepIcon #fIcon
Ds0 f26 expr out #txt
Ds0 f26 736 74 736 124 #arcP
Ds0 f15 expr out #txt
Ds0 f15 736 148 736 194 #arcP
Ds0 f27 guid 13A6360D3E6779F2 #txt
Ds0 f27 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f27 method cancelDeploy() #txt
Ds0 f27 disableUIEvents false #txt
Ds0 f27 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>cancelDeploy()</name>
    </language>
</elementInfo>
' #txt
Ds0 f27 582 694 20 20 13 0 #rect
Ds0 f27 @|RichDialogMethodStartIcon #fIcon
Ds0 f28 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f28 actionTable 'out=in;
' #txt
Ds0 f28 actionCode 'import ch.ivyteam.ivy.admin.tool.deploymentwizardserver.ProjectInfo;

if (in.deployer != null)
{
	in.isDeploymentCancelled = true;
	in.deployer.abort();
	in.deployer.stop();
}' #txt
Ds0 f28 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f28 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>cancel deploy</name>
        <nameStyle>13,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f28 574 748 36 24 20 -2 #rect
Ds0 f28 @|RichDialogProcessStepIcon #fIcon
Ds0 f29 expr out #txt
Ds0 f29 592 714 592 748 #arcP
Ds0 f31 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f31 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>is deploy cancelled?</name>
        <nameStyle>20,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f31 922 426 28 28 7 -30 #rect
Ds0 f31 @|AlternativeIcon #fIcon
Ds0 f34 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f34 actionTable 'out=in;
' #txt
Ds0 f34 actionCode 'in.isDeploymentCancelled = false;' #txt
Ds0 f34 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f34 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>reset isDeployCancelled
 variable</name>
        <nameStyle>33,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f34 918 580 36 24 6 -47 #rect
Ds0 f34 @|RichDialogProcessStepIcon #fIcon
Ds0 f33 expr out #txt
Ds0 f33 936 604 250 640 #arcP
Ds0 f33 1 936 640 #addKink
Ds0 f33 1 0.4195955068105041 0 0 #arcLabel
Ds0 f36 actionCode panel.fireDisplayCancelButton(); #txt
Ds0 f36 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f36 fireEvent displayCancelButton() #txt
Ds0 f36 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>display Cancel button</name>
        <nameStyle>21,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f36 918 356 36 24 20 -2 #rect
Ds0 f36 @|RichDialogFireEventIcon #fIcon
Ds0 f32 expr out #txt
Ds0 f32 936 380 936 426 #arcP
Ds0 f41 actionCode panel.fireDisplayCancelButton(); #txt
Ds0 f41 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f41 fireEvent displayCancelButton() #txt
Ds0 f41 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>display Cancel button</name>
        <nameStyle>21,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f41 574 804 36 24 20 -2 #rect
Ds0 f41 @|RichDialogFireEventIcon #fIcon
Ds0 f42 expr out #txt
Ds0 f42 592 772 592 804 #arcP
Ds0 f42 0 0.5425302538874693 0 0 #arcLabel
Ds0 f38 guid 13B8E3B20748854C #txt
Ds0 f38 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f38 method getLogEntry() #txt
Ds0 f38 disableUIEvents false #txt
Ds0 f38 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f38 outParameterDecl '<java.lang.String deployLog> result;
' #txt
Ds0 f38 outActionCode 'result.deployLog = "";
String text = panel.textAreaDeployLog.getText();
if (text != null && text.length() > 0) {
	result.deployLog = text;
}' #txt
Ds0 f38 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getLogEntry()</name>
        <nameStyle>13,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f38 446 694 20 20 13 0 #rect
Ds0 f38 @|RichDialogMethodStartIcon #fIcon
Ds0 f39 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f39 446 878 20 20 13 0 #rect
Ds0 f39 @|RichDialogProcessEndIcon #fIcon
Ds0 f46 expr out #txt
Ds0 f46 456 714 456 878 #arcP
Ds0 f14 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f14 actionTable 'out=in;
' #txt
Ds0 f14 actionCode 'import ch.ivyteam.ivy.admin.tool.deploymentwizardserver.deployment.DeploymentLogger;

in.isDeploymentFailed = in.deployer.isFailDeployment();

//Clear error log
DeploymentLogger.getDeploymentLogError().clear();
' #txt
Ds0 f14 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f14 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>set deployment 
status</name>
        <nameStyle>22,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f14 1086 428 36 24 24 -35 #rect
Ds0 f14 @|RichDialogProcessStepIcon #fIcon
Ds0 f45 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f45 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>is deployment failed?</name>
        <nameStyle>21,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f45 1090 498 28 28 -71 -36 #rect
Ds0 f45 @|AlternativeIcon #fIcon
Ds0 f47 expr out #txt
Ds0 f47 1104 452 1104 498 #arcP
Ds0 f48 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f48 actionTable 'out=in;
' #txt
Ds0 f48 actionCode '//Display the deployment failed status on Deployment Mask
panel.lblDeployProject.setText(ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/component/labelName/deploymentFailed"));
panel.lblDeployStatus.setText("");





' #txt
Ds0 f48 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f48 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Update Mask</name>
        <nameStyle>11,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f48 1190 500 36 24 6 -37 #rect
Ds0 f48 @|RichDialogProcessStepIcon #fIcon
Ds0 f49 expr in #txt
Ds0 f49 outCond in.isDeploymentFailed #txt
Ds0 f49 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Yes</name>
        <nameStyle>3,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f49 1118 512 1190 512 #arcP
Ds0 f49 0 0.4861111111111111 0 -10 #arcLabel
Ds0 f50 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f50 1198 630 20 20 13 0 #rect
Ds0 f50 @|RichDialogProcessEndIcon #fIcon
Ds0 f51 expr out #txt
Ds0 f51 1208 524 1208 630 #arcP
Ds0 f57 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f57 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>any project 
deployed</name>
        <nameStyle>21,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f57 922 490 28 28 19 -11 #rect
Ds0 f57 @|AlternativeIcon #fIcon
Ds0 f59 targetWindow NEW:card: #txt
Ds0 f59 targetDisplay TOP #txt
Ds0 f59 richDialogId ch.ivyteam.ivy.admin.tool.deploymentwizardserver.ErrorDialog #txt
Ds0 f59 startMethod warning(String) #txt
Ds0 f59 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f59 requestActionDecl '<String warning> param;' #txt
Ds0 f59 requestActionCode 'param.warning = ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/message/warningDeploymentAbort");
param.warning += in.message;' #txt
Ds0 f59 responseActionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f59 responseMappingAction 'out=in;
' #txt
Ds0 f59 windowConfiguration '{/title "<%=ivy.cms.co(\"/Dialogs/general/warning\")%>"/width 0 /height 0 /centered true /resizable true /maximized false /close_after_last_rd true }' #txt
Ds0 f59 isAsynch false #txt
Ds0 f59 isInnerRd true #txt
Ds0 f59 userContext '* ' #txt
Ds0 f59 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Show warning</name>
        <nameStyle>12,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f59 1334 116 36 24 21 -2 #rect
Ds0 f59 @|RichDialogIcon #fIcon
Ds0 f61 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f61 814 582 20 20 13 0 #rect
Ds0 f61 @|RichDialogProcessEndIcon #fIcon
Ds0 f35 expr in #txt
Ds0 f35 outCond in.isDeploymentCancelled #txt
Ds0 f35 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>yes</name>
        <nameStyle>3
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f35 936 454 936 490 #arcP
Ds0 f35 0 0.38636363636363635 -14 0 #arcLabel
Ds0 f40 expr in #txt
Ds0 f40 outCond in.message.isEmpty() #txt
Ds0 f40 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>No</name>
        <nameStyle>2,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f40 936 518 936 580 #arcP
Ds0 f40 0 0.45161290322580644 -14 0 #arcLabel
Ds0 f54 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f54 actionTable 'out=in;
' #txt
Ds0 f54 actionCode 'panel.lblDeployProject.setText(ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/component/labelName/deploymentAbort"));
panel.lblDeployStatus.setText("");
ivy.rd.clickDeferred(panel.hidden_btnShowWarning);' #txt
Ds0 f54 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f54 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Update title
and status</name>
        <nameStyle>23,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f54 806 492 36 24 -31 -51 #rect
Ds0 f54 @|RichDialogProcessStepIcon #fIcon
Ds0 f55 expr in #txt
Ds0 f55 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Yes</name>
        <nameStyle>3,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f55 922 504 842 504 #arcP
Ds0 f55 0 0.45 0 11 #arcLabel
Ds0 f56 expr out #txt
Ds0 f56 824 516 824 582 #arcP
Ds0 f63 guid 13C4BC1DAEEF744C #txt
Ds0 f63 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f63 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f63 actionTable 'out=in;
' #txt
Ds0 f63 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>hidden_showWarning</name>
        <nameStyle>18,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f63 1342 54 20 20 18 -8 #rect
Ds0 f63 @|RichDialogProcessStartIcon #fIcon
Ds0 f64 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f64 1342 182 20 20 13 0 #rect
Ds0 f64 @|RichDialogProcessEndIcon #fIcon
Ds0 f52 expr out #txt
Ds0 f52 1352 74 1352 116 #arcP
Ds0 f58 expr out #txt
Ds0 f58 1352 140 1352 182 #arcP
Ds0 f60 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f60 actionTable 'out=in;
' #txt
Ds0 f60 actionCode 'import ch.ivyteam.ivy.admin.tool.deploymentwizardserver.ProjectInfo;
import java.util.ArrayList;

in.message = "";
String separatorLine = System.getProperty("line.separator");
String whiteSpace = "       ";
if(in.deployer != null)
{
	List<ProjectInfo> undeployed = new ArrayList();
	List<ProjectInfo> deployedProjects = new ArrayList();
									deployedProjects.addAll(in.deployer.getDeployedProjects().deepClone());

	List<ProjectInfo> undeployedProjects = new ArrayList();
									undeployedProjects.addAll(in.deployer.getUndeployedProjects().deepClone());

	if(deployedProjects != null)
	{
		if(!deployedProjects.isEmpty())
		{
			//Display the deployed project
			in.message += separatorLine; 
			in.message += ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/message/warningCleanDeployedProject");
			for(int i = 0; i < deployedProjects.size(); i++)
			{
				int orderz = i + 1;
				in.message += separatorLine + whiteSpace + orderz + ") ";
				in.message += ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/component/tableHeaderName/project") + ": ";
				in.message += deployedProjects.get(i).getProjectName() + " -> ";
				in.message += ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/component/tableHeaderName/application") + ": ";
				in.message += deployedProjects.get(i).getApplication() + ", ";
				in.message += ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/component/tableHeaderName/pm") + ": ";
				in.message += deployedProjects.get(i).getProcessModel() + ", ";
				in.message += ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/component/tableHeaderName/pmv") + ": ";
				in.message += deployedProjects.get(i).getProcessModelVersion().toString()+ ".";
			}
		}	
		//Display list of undeploy project
		if(in.projectList.size() > deployedProjects.size() && undeployedProjects != null)
		{
			in.message += separatorLine;
			in.message += ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/message/warningProjectNotDeploy");
			int orderz = 1;
			for( ProjectInfo undeployedProject : undeployedProjects)
			{
						in.message += separatorLine + whiteSpace + orderz +") ";
						in.message += ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/component/tableHeaderName/project") + ": ";
						in.message += undeployedProject.getProjectName() + whiteSpace;
						in.message += ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/message/deployTo") + whiteSpace;
						in.message += ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/component/tableHeaderName/application") + ": ";
						in.message += whiteSpace + undeployedProject.getApplication();
				orderz++;
			}
		}
	}
	deployedProjects.clear();
	undeployedProjects.clear();
}



	

 

' #txt
Ds0 f60 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f60 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Collecting 
deployed projects</name>
        <nameStyle>29,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f60 918 292 36 24 23 -24 #rect
Ds0 f60 @|RichDialogProcessStepIcon #fIcon
Ds0 f62 expr out #txt
Ds0 f62 936 252 936 292 #arcP
Ds0 f62 0 0.8766050541694315 0 0 #arcLabel
Ds0 f37 expr out #txt
Ds0 f37 936 316 936 356 #arcP
Ds0 f43 expr in #txt
Ds0 f43 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>no</name>
        <nameStyle>2
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f43 950 440 1086 440 #arcP
Ds0 f43 0 0.41358024691358025 -1 11 #arcLabel
Ds0 f65 actionDecl 'ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData out;
' #txt
Ds0 f65 actionTable 'out=in;
' #txt
Ds0 f65 actionCode panel.lblDeployProject.setText(ivy.cms.co("/ch/ivyteam/ivy/server/deploymentWizard/component/labelName/deploymentFinished")); #txt
Ds0 f65 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f65 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>update title
status</name>
        <nameStyle>13,7
6,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f65 1086 564 36 24 25 -9 #rect
Ds0 f65 @|RichDialogProcessStepIcon #fIcon
Ds0 f66 expr in #txt
Ds0 f66 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>No</name>
        <nameStyle>2,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f66 1104 526 1104 564 #arcP
Ds0 f66 0 0.48936170212765956 13 0 #arcLabel
Ds0 f44 expr out #txt
Ds0 f44 1104 588 1104 628 #arcP
Ds0 f72 expr out #txt
Ds0 f72 240 74 240 196 #arcP
Ds0 f67 expr out #txt
Ds0 f67 592 828 466 888 #arcP
Ds0 f67 1 592 888 #addKink
Ds0 f67 1 0.24800449041356368 0 0 #arcLabel
Ds0 f5 guid 13D482098AD1D838 #txt
Ds0 f5 type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
Ds0 f5 method getSuccessfulDeployedProjects() #txt
Ds0 f5 disableUIEvents false #txt
Ds0 f5 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f5 outParameterDecl '<java.lang.Integer deployedProjects> result;
' #txt
Ds0 f5 outActionCode 'if (in.deployer == null || in.deployer.getDeployedProjects() == null)
{
	result.deployedProjects = 0;
}
else 
{
	result.deployedProjects = in.deployer.getDeployedProjects().size();
}' #txt
Ds0 f5 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getSuccessfulDeployedProjects()</name>
        <nameStyle>31,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f5 238 694 20 20 13 0 #rect
Ds0 f5 @|RichDialogMethodStartIcon #fIcon
Ds0 f30 expr out #txt
Ds0 f30 248 714 446 888 #arcP
Ds0 f30 1 248 888 #addKink
Ds0 f30 0 0.9474460551511925 0 0 #arcLabel
>Proto Ds0 .rdData2UIAction 'panel.progressBarDeploy.maximum=in.#progressMonitor is initialized ? in.progressMonitor.getTotalWork() : 0;
panel.progressBarDeploy.value=in.#progressMonitor is initialized ? in.progressMonitor.getWorked() : 0;
' #txt
>Proto Ds0 .type ch.ivyteam.ivy.admin.tool.deploymentwizardserver.Deploy.DeployData #txt
>Proto Ds0 .processKind RICH_DIALOG #txt
>Proto Ds0 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <swimlaneLabel>Start</swimlaneLabel>
        <swimlaneLabel>Method</swimlaneLabel>
        <swimlaneLabel>EVENT</swimlaneLabel>
        <swimlaneLabel></swimlaneLabel>
    </language>
    <swimlaneSize>200</swimlaneSize>
    <swimlaneSize>1104</swimlaneSize>
    <swimlaneSize>376</swimlaneSize>
    <swimlaneColor>-10066177</swimlaneColor>
    <swimlaneColor>-26266</swimlaneColor>
    <swimlaneColor>-6710887</swimlaneColor>
</elementInfo>
' #txt
>Proto Ds0 -8 -8 16 16 16 26 #rect
>Proto Ds0 '' #fIcon
Ds0 f0 mainOut f2 tail #connect
Ds0 f2 head f1 mainIn #connect
Ds0 f8 mainOut f9 tail #connect
Ds0 f9 head f6 mainIn #connect
Ds0 f10 mainOut f11 tail #connect
Ds0 f11 head f6 mainIn #connect
Ds0 f19 out f22 tail #connect
Ds0 f22 head f21 mainIn #connect
Ds0 f4 mainOut f7 tail #connect
Ds0 f7 head f6 mainIn #connect
Ds0 f19 out f16 tail #connect
Ds0 f16 head f24 mainIn #connect
Ds0 f21 mainOut f17 tail #connect
Ds0 f17 head f6 mainIn #connect
Ds0 f13 mainOut f18 tail #connect
Ds0 f18 head f6 mainIn #connect
Ds0 f20 mainOut f23 tail #connect
Ds0 f23 head f6 mainIn #connect
Ds0 f12 mainOut f26 tail #connect
Ds0 f26 head f25 mainIn #connect
Ds0 f25 mainOut f15 tail #connect
Ds0 f15 head f19 in #connect
Ds0 f27 mainOut f29 tail #connect
Ds0 f29 head f28 mainIn #connect
Ds0 f34 mainOut f33 tail #connect
Ds0 f33 head f6 mainIn #connect
Ds0 f36 mainOut f32 tail #connect
Ds0 f32 head f31 in #connect
Ds0 f28 mainOut f42 tail #connect
Ds0 f42 head f41 mainIn #connect
Ds0 f38 mainOut f46 tail #connect
Ds0 f46 head f39 mainIn #connect
Ds0 f14 mainOut f47 tail #connect
Ds0 f47 head f45 in #connect
Ds0 f45 out f49 tail #connect
Ds0 f49 head f48 mainIn #connect
Ds0 f48 mainOut f51 tail #connect
Ds0 f51 head f50 mainIn #connect
Ds0 f31 out f35 tail #connect
Ds0 f35 head f57 in #connect
Ds0 f57 out f40 tail #connect
Ds0 f40 head f34 mainIn #connect
Ds0 f57 out f55 tail #connect
Ds0 f55 head f54 mainIn #connect
Ds0 f54 mainOut f56 tail #connect
Ds0 f56 head f61 mainIn #connect
Ds0 f63 mainOut f52 tail #connect
Ds0 f52 head f59 mainIn #connect
Ds0 f59 mainOut f58 tail #connect
Ds0 f58 head f64 mainIn #connect
Ds0 f24 mainOut f62 tail #connect
Ds0 f62 head f60 mainIn #connect
Ds0 f60 mainOut f37 tail #connect
Ds0 f37 head f36 mainIn #connect
Ds0 f31 out f43 tail #connect
Ds0 f43 head f14 mainIn #connect
Ds0 f45 out f66 tail #connect
Ds0 f66 head f65 mainIn #connect
Ds0 f65 mainOut f44 tail #connect
Ds0 f44 head f13 mainIn #connect
Ds0 f3 mainOut f72 tail #connect
Ds0 f72 head f4 mainIn #connect
Ds0 f41 mainOut f67 tail #connect
Ds0 f67 head f39 mainIn #connect
Ds0 f5 mainOut f30 tail #connect
Ds0 f30 head f39 mainIn #connect
